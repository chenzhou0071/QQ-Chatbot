# 系统架构文档

## 架构概览

本文档详细描述QQ智能聊天机器人的系统架构设计。

## 分层架构

```
┌─────────────────────────────────────────┐
│         表示层 (Presentation)            │
│         QQ客户端 / 群聊界面              │
└──────────────┬──────────────────────────┘
               │ OneBot V11 Protocol
┌──────────────▼──────────────────────────┐
│         协议层 (Protocol)                │
│         NapCat WebSocket Server          │
└──────────────┬──────────────────────────┘
               │
┌──────────────▼──────────────────────────┐
│         框架层 (Framework)               │
│         NoneBot2 Event System            │
└──────────────┬──────────────────────────┘
               │
┌──────────────▼──────────────────────────┐
│         应用层 (Application)             │
│    Triggers → Plugins → Dialogue         │
└──────────────┬──────────────────────────┘
               │
┌──────────────▼──────────────────────────┐
│         服务层 (Service)                 │
│    Memory | AI Client | Utils            │
└──────────────┬──────────────────────────┘
               │
┌──────────────▼──────────────────────────┐
│         数据层 (Data)                    │
│    SQLite | Chroma | External APIs       │
└──────────────────────────────────────────┘
```

## 核心组件

### 1. 消息处理流水线

```
消息接收 → 路由分发 → 触发判断 → 插件处理 → 响应生成 → 消息发送
```

### 2. 对话智能引擎

```
意图分析 → 状态管理 → 上下文增强 → 主动对话
```

### 3. 记忆系统

```
短期记忆 (Cache) ← → 长期记忆 (SQLite) ← → 语义记忆 (Vector)
```

## 详细设计

参见 [PROJECT_OVERVIEW.md](PROJECT_OVERVIEW.md) 获取完整架构说明。
