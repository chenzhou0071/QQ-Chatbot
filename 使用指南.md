# QQ Bot 使用指南

## 🚀 快速开始

### 第一步：安装

1. 双击运行 `install.bat`
2. 等待安装完成

### 第二步：配置

1. 打开 `config/.env`，填写 AI API Key：
   ```
   DEEPSEEK_API_KEY=sk-xxxxx
   ```

2. 打开 `config/config.yaml`，修改基本配置：
   ```yaml
   bot:
     qq_number: '你的Bot QQ号'
     admin_qq: '管理员QQ号'
     target_group: '目标群号'
   ```

### 第三步：启动

1. 双击运行 `启动.bat`
2. 在 NapCat 窗口扫码登录 QQ
3. 浏览器会自动打开 Web 管理界面
4. 在 Web 界面点击"启动 Bot"

## 🎭 自定义人设

在 Web 界面的"配置管理"页面，可以自定义：

### 基本信息
- **名字**：Bot 的正式名字
- **昵称**：Bot 的昵称（更亲切）
- **背景故事**：Bot 的身世背景

### 外貌特征
- **身高**：例如 165cm
- **发型**：例如 利落的黑色短发
- **五官**：例如 五官清秀柔和
- **气质**：例如 干净内敛

### 性格设定
- **核心性格**：例如 腼腆害羞，慢热内敛
- **性格特质**：多行文本，每行一个特质

### 说话风格
- **语气**：例如 软糯、轻柔、温和
- **说话方式**：例如 略带拘谨、有点害羞
- **回应风格**：例如 简短、温柔、不过分热情
- **表情使用**：例如 适度使用，偏向可爱害羞类

### 管理员关系
- **管理员名字**：例如 栖云
- **与管理员的关系**：例如 收养你、照顾你的人
- **管理员详细描述**：详细描述管理员信息和你对管理员的感情

## 💬 触发方式

### 1. @触发
在群里 @Bot，Bot 会回复

### 2. 名字触发
消息中包含 Bot 的名字或昵称，Bot 会回复

例如：
- "舟舟"
- "沉舟在吗"

### 3. 关键词触发
配置的关键词会触发固定回复

默认关键词：
- "帮助" / "/help"
- "功能"

### 4. 智能判断
Bot 会根据上下文智能判断是否回复

会回复的情况：
- 有人在和 Bot 对话
- 有人提到 Bot 之前说的话题
- 有人对 Bot 做亲密动作（摸头、抱抱等）
- 有人在回应 Bot 刚才说的话

不会回复的情况：
- 简短消息（哈哈、好的）且不是回应 Bot
- 私密的两人对话
- Bot 不懂或不感兴趣的话题

## 👥 群友管理

在 Web 界面的"群友管理"页面，可以：

- 查看所有群友信息
- 编辑群友昵称（Bot 会用这个昵称称呼对方）
- 记录群友生日
- 添加备注信息（Bot 会根据备注更好地与对方互动）
- 标记群友状态（活跃/已退群）

## 📊 查看日志

### Web 界面
在"仪表盘"页面可以查看实时日志

### 日志文件
日志文件保存在 `data/logs/` 目录：
- `bot-YYYY-MM-DD.log` - Bot 运行日志
- `error-YYYY-MM-DD.log` - 错误日志

### 实时查看
运行 `scripts/watch_log.bat` 可以实时查看日志

## 🔧 常见问题

### Bot 不回复消息？

1. 检查 Bot 是否启动（Web 界面查看状态）
2. 检查是否在目标群（config.yaml 中的 target_group）
3. 检查触发方式是否正确
4. 查看日志了解原因

### 如何修改触发概率？

在 Web 界面的"配置管理" → "触发配置"中调整"触发概率"滑块

### 如何清空记忆？

运行 `scripts/clear_memory.bat`

### 如何更换 AI 模型？

在 `config/.env` 中修改 API Key：
- DeepSeek：`DEEPSEEK_API_KEY`
- 阿里云通义千问：`DASHSCOPE_API_KEY`

## 📝 配置说明

### 主要配置项

```yaml
# Bot 基础配置
bot:
  qq_number: 'Bot QQ号'
  admin_qq: '管理员 QQ号'
  target_group: '目标群号'
  admin_name: '管理员名字'

# AI 配置
ai:
  temperature: 0.7  # 创造性（0-1，越高越随机）
  max_tokens: 1000  # 最大回复长度

# 触发配置
features:
  mention_reply: true   # @触发
  keyword_reply: true   # 关键词触发
  name_reply: true      # 名字触发
  smart_reply: true     # 智能判断

# 智能触发配置
smart_reply:
  trigger_rate: 0.65        # 触发概率（0-1）
  min_interval: 10          # 最小间隔（秒）
  continuous_window: 30     # 连续对话窗口（秒）
```

## 🛠️ 维护脚本

### 清空记忆
```bash
scripts/clear_memory.bat
```

### 清理数据
```bash
scripts/clean_data.bat
```

### 检查配置
```bash
scripts/check_config.bat
```

### 查看日志
```bash
scripts/watch_log.bat
```

## ⚠️ 注意事项

1. **API Key 安全**：不要泄露你的 API Key
2. **数据备份**：定期备份 `data/` 目录
3. **配置修改**：修改配置后需要重启 Bot
4. **群号设置**：Bot 只在配置的目标群中工作
5. **管理员权限**：只有管理员可以使用某些特殊功能

## 📞 获取帮助

- 查看日志：`data/logs/`
- 查看文档：`docs/` 目录
- 检查配置：运行 `scripts/check_config.bat`
